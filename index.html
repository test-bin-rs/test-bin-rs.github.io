<!-- ======================================================================= -->
<html>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>
    test-bin-rs
  </title>
  <body>
    <h1>test-bin-rs</h1>
    <p>What is this?</p>
    <p>
      Project <b>test-bin-rs</b> is playing with three ideas about computation and software system.
    </p>
    <h2>test</h2>
    <p>
      A <b>test</b> is a process of running through specific code paths of a runtime system. At testing stage we are interested
      in if the test passed or failed. If the test failed, we might go to debugging, which is a different stage.
    </p>
    <h2>bin</h2>
    <p>
      There are a few meanings of <b>bin</b> we are interested in.
      <ol>
        <li>
          In common English, a <b>bin</b> means a box or a place holder. So a <b>test-bin</b> can mean a place to hold a test.
        </li>
        <li>
          In mathematics, bin means <a href="https://en.wikipedia.org/wiki/Binary_number">binary number</a>.
          A test program is binary by nature because we only care about if a test passed or failed.
          We get 1 bit of information out of a test.
        </li>
        <li>
          In computer, <b>bin</b> stands for <a href="https://en.wikipedia.org/wiki/Binary_file">binary file</a>,
          which is the format of <a href="https://en.wikipedia.org/wiki/Executable">executable programs</a>.
          For historical reason in computing, we usually put the in the <b>bin</b> directory,
          although we also put script files in it, although they are human readable text files that can
          be interpreted by some runtime interpreter such as Bash, Python, Node.js, etc.
        </li>
        <li>
          In rust crate system (see below), we <a href="https://doc.rust-lang.org/cargo/guide/creating-a-new-project.html">create bin and lib crates differently</a>.
          <pre>
	    $ cargo new hello_world --bin
          </pre>
          <pre>
	    $ cargo new add --lib
          </pre>
        </li>
      </ol>
    </p>
    <h2>rs</h2>
    <p>
      <b>rs</b> stands for <a href="https://rust-lang.org">Rust Language</a> and the
      <a href="https://doc.rust-lang.org/book/ch07-01-packages-and-crates.html">crate</a> ecosystem.
    </p>
    <p>
      Rust community has a great system of
      <a href="https://doc.rust-lang.org/book/ch11-00-testing.html">unit tests and integration tests</a>.
      This is done with macros like <code>#[cfg(test)]</code> and <code>#[test]</code> so that the compiler
      will generate binary executable programs to run.
    </p>
    <p>
      This is quite different from the testing frameworks in scripting language like Python and JavaScript because
      there is no overhead of a testing framework in Rust.
      Strickly speaking, a test excutable is no different from a normal executable compiled from <code>main.rs</code>.
    </p>
    <p>
      The idea of <b>test-bin-rs</b> project is that we write simple and straight forward tests as plain
      <pre>main.rs</pre> to study the runtime behavoir of code paths of Rust crates. The code is hosted on a github repo
      at specific branches and can be installed anywhere (local or CI) and executed as normal bin crate.
    </p>
    <h2>An example of a complicated test-bin</h2>
<p>This is a test on a complicated library <a href="https://docs.rs/crate/octocrab">octocrab</a> so the <code>cargo install</code> pulls in 221 packages.</p>
<code>main.rs</code>
<pre>
use octocrab::Octocrab;

#[tokio::main]
async fn main() -> octocrab::Result<()> {
    let octocrab = Octocrab::builder().build()?;

    let repo = octocrab
        .repos("test-bin-rs", "test-bin-rs.github.io")
        .get()
        .await?;

    assert_eq!(format!("{}", repo.id), "1145166759");

    Ok(())
}
</pre>
<code>$ cargo expand</code>
<pre>
#![feature(prelude_import)]
#[macro_use]
extern crate std;
#[prelude_import]
use std::prelude::rust_2024::*;
use octocrab::Octocrab;
fn main() -> octocrab::Result<()> {
    let body = async {
        let octocrab = Octocrab::builder().build()?;
        let repo = octocrab.repos("test-bin-rs", "test-bin-rs.github.io").get().await?;
        match (
            &::alloc::__export::must_use({
                ::alloc::fmt::format(format_args!("{0}", repo.id))
            }),
            &"1145166759",
        ) {
            (left_val, right_val) => {
                if !(*left_val == *right_val) {
                    let kind = ::core::panicking::AssertKind::Eq;
                    ::core::panicking::assert_failed(
                        kind,
                        &*left_val,
                        &*right_val,
                        ::core::option::Option::None,
                    );
                }
            }
        };
        Ok(())
    };
    #[allow(
        clippy::expect_used,
        clippy::diverging_sub_expression,
        clippy::needless_return,
        clippy::unwrap_in_result
    )]
    {
        return tokio::runtime::Builder::new_multi_thread()
            .enable_all()
            .build()
            .expect("Failed building the Runtime")
            .block_on(body);
    }
}
</pre>
<pre>
$ cargo install --git https://github.com/test-bin-rs/test-bin-rs.github.io --branch assert-repo --root .cargo
    Updating git repository `https://github.com/test-bin-rs/test-bin-rs.github.io`
  Installing assert-repo v0.1.0 (https://github.com/test-bin-rs/test-bin-rs.github.io?branch=assert-repo#2923313f)
    Updating crates.io index
     Locking 221 packages to latest Rust 1.93.0 compatible versions
      Adding crypto-common v0.1.6 (available: v0.1.7)
 Downloading crates ...
  Downloaded base16ct v0.2.0
  Downloaded autocfg v1.5.0
  Downloaded cpufeatures v0.2.17
  Downloaded block-buffer v0.10.4
  Downloaded atomic-waker v1.1.2
  Downloaded cfg-if v1.0.4
  Downloaded cargo-platform v0.3.2
  Downloaded lazy_static v1.5.0
  Downloaded base64ct v1.8.3
  Downloaded rand_core v0.6.4
  Downloaded num-iter v0.1.45
  Downloaded potential_utf v0.1.4
  Downloaded futures-io v0.3.31
  Downloaded percent-encoding v2.3.2
  Downloaded openssl-probe v0.2.1
  Downloaded pin-utils v0.1.0
  Downloaded powerfmt v0.2.0
  Downloaded rustc_version v0.4.1
  Downloaded pkcs8 v0.10.2
  Downloaded rfc6979 v0.4.0
  Downloaded ppv-lite86 v0.2.21
  Downloaded rustls-native-certs v0.8.3
  Downloaded proc-macro2 v1.0.106
  Downloaded primeorder v0.13.6
  Downloaded tracing-core v0.1.36
  Downloaded sync_wrapper v1.0.2
  Downloaded untrusted v0.9.0
  Downloaded zerofrom-derive v0.1.6
  Downloaded time-core v0.1.8
  Downloaded tower-service v0.3.3
  Downloaded serde_path_to_error v0.1.20
  Downloaded tokio-macros v2.6.0
  Downloaded tinystr v0.8.2
  Downloaded zerovec-derive v0.11.2
  Downloaded writeable v0.6.2
  Downloaded zmij v1.0.17
  Downloaded serde_core v1.0.228
  Downloaded zerotrie v0.2.3
  Downloaded tokio-util v0.7.18
  Downloaded tower v0.5.3
  Downloaded zerovec v0.11.5
  Downloaded time v0.3.46
  Downloaded serde v1.0.228
  Downloaded zerocopy v0.8.36
  Downloaded octocrab v0.49.5
  Downloaded url v2.5.8
  Downloaded tower-http v0.6.8
  Downloaded rustls-webpki v0.103.9
  Downloaded rustls v0.23.36
  Downloaded yoke v0.8.1
  Downloaded web-time v1.1.0
  Downloaded tracing-attributes v0.1.31
  Downloaded typenum v1.19.0
  Downloaded tokio v1.49.0
  Downloaded stable_deref_trait v1.2.1
  Downloaded semver v1.0.27
  Downloaded sec1 v0.7.3
  Downloaded ryu v1.0.22
  Downloaded syn v2.0.114
  Downloaded want v0.3.1
  Downloaded utf8_iter v1.0.4
  Downloaded thiserror v2.0.18
  Downloaded ring v0.17.14
  Downloaded libc v0.2.180
  Downloaded smallvec v1.15.1
  Downloaded serde_derive v1.0.228
  Downloaded rustversion v1.0.22
  Downloaded zeroize v1.8.2
  Downloaded zerofrom v0.1.6
  Downloaded try-lock v0.2.5
  Downloaded time-macros v0.2.26
  Downloaded spki v0.7.3
  Downloaded spin v0.9.8
  Downloaded tracing v0.1.44
  Downloaded snafu v0.8.9
  Downloaded shlex v1.3.0
  Downloaded rustls-pki-types v1.14.0
  Downloaded curve25519-dalek v4.1.3
  Downloaded thiserror-impl v2.0.18
  Downloaded chrono v0.4.43
  Downloaded slab v0.4.11
  Downloaded simple_asn1 v0.6.3
  Downloaded sha2 v0.10.9
  Downloaded serde_urlencoded v0.7.1
  Downloaded serde_json v1.0.149
  Downloaded yoke-derive v0.8.1
  Downloaded version_check v0.9.5
  Downloaded unicode-ident v1.0.22
  Downloaded tower-layer v0.3.3
  Downloaded tokio-rustls v0.26.4
  Downloaded synstructure v0.13.2
  Downloaded subtle v2.6.1
  Downloaded socket2 v0.6.2
  Downloaded signature v2.2.0
  Downloaded secrecy v0.10.3
  Downloaded p384 v0.13.1
  Downloaded hyper v1.8.1
  Downloaded hkdf v0.12.4
  Downloaded snafu-derive v0.8.9
  Downloaded libm v0.2.16
  Downloaded iri-string v0.7.10
  Downloaded idna v1.1.0
  Downloaded icu_properties_data v2.1.2
  Downloaded futures-util v0.3.31
  Downloaded rsa v0.9.10
  Downloaded http v1.4.0
  Downloaded rand v0.8.5
  Downloaded num-bigint-dig v0.8.6
  Downloaded hyper-util v0.1.19
  Downloaded num-bigint v0.4.6
  Downloaded mio v1.1.1
  Downloaded memchr v2.7.6
  Downloaded crypto-bigint v0.5.5
  Downloaded icu_normalizer v2.1.1
  Downloaded icu_locale_core v2.1.1
  Downloaded icu_collections v2.1.1
  Downloaded hmac v0.12.1
  Downloaded elliptic-curve v0.13.8
  Downloaded ed25519-dalek v2.2.0
  Downloaded der v0.7.10
  Downloaded cc v1.2.54
  Downloaded base64 v0.22.1
  Downloaded pin-project v1.1.10
  Downloaded log v0.4.29
  Downloaded icu_provider v2.1.1
  Downloaded icu_properties v2.1.2
  Downloaded icu_normalizer_data v2.1.1
  Downloaded futures v0.3.31
  Downloaded bytes v1.11.0
  Downloaded pkcs1 v0.7.5
  Downloaded p256 v0.13.2
  Downloaded num-traits v0.2.19
  Downloaded litemap v0.8.1
  Downloaded jsonwebtoken v10.3.0
  Downloaded hyper-rustls v0.27.7
  Downloaded getrandom v0.2.17
  Downloaded quote v1.0.44
  Downloaded pem v3.0.6
  Downloaded once_cell v1.21.3
  Downloaded iana-time-zone v0.1.65
  Downloaded hyper-timeout v0.5.2
  Downloaded httparse v1.10.1
  Downloaded futures-executor v0.3.31
  Downloaded ecdsa v0.16.9
  Downloaded pin-project-lite v0.2.16
  Downloaded pin-project-internal v1.1.10
  Downloaded pem-rfc7468 v0.7.0
  Downloaded group v0.13.0
  Downloaded generic-array v0.14.9
  Downloaded ed25519 v2.2.3
  Downloaded displaydoc v0.2.5
  Downloaded const-oid v0.9.6
  Downloaded camino v1.2.2
  Downloaded bitflags v2.10.0
  Downloaded rand_chacha v0.3.1
  Downloaded num-integer v0.1.46
  Downloaded itoa v1.0.17
  Downloaded http-body-util v0.1.3
  Downloaded futures-channel v0.3.31
  Downloaded form_urlencoded v1.2.2
  Downloaded find-msvc-tools v0.1.8
  Downloaded ff v0.13.1
  Downloaded either v1.15.0
  Downloaded digest v0.10.7
  Downloaded deranged v0.5.5
  Downloaded num-conv v0.2.0
  Downloaded idna_adapter v1.2.1
  Downloaded http-body v1.0.1
  Downloaded crypto-common v0.1.6
  Downloaded cargo_metadata v0.23.1
  Downloaded async-trait v0.1.89
  Downloaded arc-swap v1.8.0
  Downloaded heck v0.5.0
  Downloaded futures-task v0.3.31
  Downloaded futures-sink v0.3.31
  Downloaded futures-macro v0.3.31
  Downloaded futures-core v0.3.31
  Downloaded curve25519-dalek-derive v0.1.1
   Compiling proc-macro2 v1.0.106
   Compiling quote v1.0.44
   Compiling unicode-ident v1.0.22
   Compiling libc v0.2.180
   Compiling zeroize v1.8.2
   Compiling cfg-if v1.0.4
   Compiling version_check v0.9.5
   Compiling subtle v2.6.1
   Compiling typenum v1.19.0
   Compiling generic-array v0.14.9
   Compiling const-oid v0.9.6
   Compiling serde_core v1.0.228
   Compiling base64ct v1.8.3
   Compiling pem-rfc7468 v0.7.0
   Compiling getrandom v0.2.17
   Compiling block-buffer v0.10.4
   Compiling syn v2.0.114
   Compiling rand_core v0.6.4
   Compiling crypto-common v0.1.6
   Compiling digest v0.10.7
   Compiling pin-project-lite v0.2.16
   Compiling itoa v1.0.17
   Compiling der v0.7.10
   Compiling stable_deref_trait v1.2.1
   Compiling futures-core v0.3.31
   Compiling smallvec v1.15.1
   Compiling serde v1.0.228
   Compiling libm v0.2.16
   Compiling autocfg v1.5.0
   Compiling spki v0.7.3
   Compiling pkcs8 v0.10.2
   Compiling futures-sink v0.3.31
   Compiling num-traits v0.2.19
   Compiling bytes v1.11.0
   Compiling memchr v2.7.6
   Compiling zmij v1.0.17
   Compiling synstructure v0.13.2
   Compiling futures-channel v0.3.31
   Compiling semver v1.0.27
   Compiling mio v1.1.1
   Compiling socket2 v0.6.2
   Compiling once_cell v1.21.3
   Compiling shlex v1.3.0
   Compiling zerofrom-derive v0.1.6
   Compiling yoke-derive v0.8.1
   Compiling zerovec-derive v0.11.2
   Compiling displaydoc v0.2.5
   Compiling tokio-macros v2.6.0
   Compiling zerofrom v0.1.6
   Compiling yoke v0.8.1
   Compiling serde_derive v1.0.228
   Compiling zerovec v0.11.5
   Compiling find-msvc-tools v0.1.8
   Compiling pin-utils v0.1.0
   Compiling tokio v1.49.0
   Compiling cc v1.2.54
   Compiling futures-macro v0.3.31
   Compiling hmac v0.12.1
   Compiling futures-io v0.3.31
   Compiling log v0.4.29
   Compiling futures-task v0.3.31
   Compiling zerocopy v0.8.36
   Compiling slab v0.4.11
   Compiling ring v0.17.14
   Compiling futures-util v0.3.31
   Compiling tinystr v0.8.2
   Compiling thiserror-impl v2.0.18
   Compiling http v1.4.0
   Compiling signature v2.2.0
   Compiling ff v0.13.1
   Compiling base16ct v0.2.0
   Compiling litemap v0.8.1
   Compiling writeable v0.6.2
   Compiling sec1 v0.7.3
   Compiling icu_locale_core v2.1.1
   Compiling group v0.13.0
   Compiling http-body v1.0.1
   Compiling num-integer v0.1.46
   Compiling hkdf v0.12.4
   Compiling potential_utf v0.1.4
   Compiling zerotrie v0.2.3
   Compiling tracing-attributes v0.1.31
   Compiling tracing-core v0.1.36
   Compiling crypto-bigint v0.5.5
   Compiling icu_normalizer_data v2.1.1
   Compiling httparse v1.10.1
   Compiling icu_properties_data v2.1.2
   Compiling cpufeatures v0.2.17
   Compiling tracing v0.1.44
   Compiling ppv-lite86 v0.2.21
   Compiling elliptic-curve v0.13.8
   Compiling icu_provider v2.1.1
   Compiling icu_collections v2.1.1
   Compiling rustc_version v0.4.1
   Compiling rustls-pki-types v1.14.0
   Compiling tower-service v0.3.3
   Compiling camino v1.2.2
   Compiling thiserror v2.0.18
   Compiling untrusted v0.9.0
   Compiling serde_json v1.0.149
   Compiling try-lock v0.2.5
   Compiling want v0.3.1
   Compiling curve25519-dalek v4.1.3
   Compiling rand_chacha v0.3.1
   Compiling sha2 v0.10.9
   Compiling rfc6979 v0.4.0
   Compiling spin v0.9.8
   Compiling num-conv v0.2.0
   Compiling atomic-waker v1.1.2
   Compiling time-core v0.1.8
   Compiling powerfmt v0.2.0
   Compiling rustls v0.23.36
   Compiling num-bigint-dig v0.8.6
   Compiling deranged v0.5.5
   Compiling time-macros v0.2.26
   Compiling hyper v1.8.1
   Compiling lazy_static v1.5.0
   Compiling ecdsa v0.16.9
   Compiling icu_properties v2.1.2
   Compiling icu_normalizer v2.1.1
   Compiling rand v0.8.5
   Compiling primeorder v0.13.6
   Compiling num-iter v0.1.45
   Compiling curve25519-dalek-derive v0.1.1
   Compiling cargo-platform v0.3.2
   Compiling rustversion v1.0.22
   Compiling percent-encoding v2.3.2
   Compiling time v0.3.46
   Compiling form_urlencoded v1.2.2
   Compiling cargo_metadata v0.23.1
   Compiling rustls-webpki v0.103.9
   Compiling idna_adapter v1.2.1
   Compiling hyper-util v0.1.19
   Compiling num-bigint v0.4.6
   Compiling ed25519 v2.2.3
   Compiling tokio-util v0.7.18
   Compiling pkcs1 v0.7.5
   Compiling tower-layer v0.3.3
   Compiling sync_wrapper v1.0.2
   Compiling heck v0.5.0
   Compiling openssl-probe v0.2.1
   Compiling base64 v0.22.1
   Compiling utf8_iter v1.0.4
   Compiling idna v1.1.0
   Compiling pem v3.0.6
   Compiling snafu-derive v0.8.9
   Compiling rustls-native-certs v0.8.3
   Compiling tower v0.5.3
   Compiling rsa v0.9.10
   Compiling tokio-rustls v0.26.4
   Compiling ed25519-dalek v2.2.0
   Compiling simple_asn1 v0.6.3
   Compiling octocrab v0.49.5
   Compiling p256 v0.13.2
   Compiling p384 v0.13.1
   Compiling futures-executor v0.3.31
   Compiling pin-project-internal v1.1.10
   Compiling ryu v1.0.22
   Compiling bitflags v2.10.0
   Compiling iana-time-zone v0.1.65
   Compiling iri-string v0.7.10
   Compiling pin-project v1.1.10
   Compiling chrono v0.4.43
   Compiling serde_urlencoded v0.7.1
   Compiling futures v0.3.31
   Compiling jsonwebtoken v10.3.0
   Compiling tower-http v0.6.8
   Compiling arc-swap v1.8.0
   Compiling hyper-rustls v0.27.7
   Compiling snafu v0.8.9
   Compiling url v2.5.8
   Compiling hyper-timeout v0.5.2
   Compiling http-body-util v0.1.3
   Compiling serde_path_to_error v0.1.20
   Compiling async-trait v0.1.89
   Compiling secrecy v0.10.3
   Compiling web-time v1.1.0
   Compiling either v1.15.0
   Compiling assert-repo v0.1.0 (/home/runner/.cargo/git/checkouts/test-bin-rs.github.io-680e80485e0bc535/2923313)
    Finished `release` profile [optimized] target(s) in 1m 32s
  Installing /home/runner/work/test-bin-rs.github.io/test-bin-rs.github.io/.cargo/bin/assert-repo
   Installed package `assert-repo v0.1.0 (https://github.com/test-bin-rs/test-bin-rs.github.io?branch=assert-repo#2923313f)` (executable `assert-repo`)
warning: be sure to add `/home/runner/work/test-bin-rs.github.io/test-bin-rs.github.io/.cargo/bin` to your PATH to be able to run the installed binaries
file .cargo/bin/assert-repo
.cargo/bin/assert-repo: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=afad3da95e3b0eb278dab6f303b2abb01dfa9035, not stripped
.cargo/bin/assert-repo
</pre>
The program has no output so if the CI passed, everything is OK.
You can find the same output in <a href="https://github.com/test-bin-rs/test-bin-rs.github.io/actions?query=branch%3Atest-bin">CI workflow</a>.
<p>
If you are curious, here is the <a href="doc/test_assert_repo/index.html">cargo doc</a> generated by
<pre>
cargo doc --bin test-assert-repo
</pre>
</p>
  </body>
</html>
<!-- ======================================================================= -->
